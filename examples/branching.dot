digraph Branch {
    graph [goal="Implement and validate a feature"]
    rankdir=LR
    node [shape=box, timeout="900s"]
    
    start     [shape=Mdiamond, label="Start"]
    exit      [shape=Msquare, label="Exit"]
    plan      [label="Plan", prompt="Plan the implementation for $goal"]
    implement [label="Implement", prompt="Implement the plan", goal_gate=true]
    validate  [label="Validate", prompt="Run tests and validate"]
    gate      [shape=diamond, label="Tests passing?"]
    
    start -> plan -> implement -> validate -> gate
    gate -> exit      [label="Yes", condition="outcome=success"]
    gate -> implement [label="No", condition="outcome!=success"]
}
